<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encurtador de Links</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Encurte seus links</h1>
        <p>Transforme URLs enormes em links curtos e práticos</p>
    </header>

    <main>
        <form id="form-encurtar">
            <input type="text" id="url" placeholder="Cole seu link aqui..." required>
            <button type="submit">Encurtar</button>
        </form>

        <div id="resultado" class="oculto">
            <p>Seu link encurtado:</p>
            <a id="link-curto" target="_blank"></a>
        </div>
    </main>

    <footer>
        <p>Desenvolvido para testes com Supabase + Render</p>
    </footer>

    <script>
        document.getElementById('form-encurtar').addEventListener('submit', async (e) => {
            e.preventDefault();
            const url = document.getElementById('url').value;

            try {
                const res = await fetch('/encurtar', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url })
                });
                const data = await res.json();

                if (data.shortUrl) {
                    const resultado = document.getElementById('resultado');
                    const linkCurto = document.getElementById('link-curto');
                    linkCurto.href = data.shortUrl;
                    linkCurto.textContent = data.shortUrl;
                    resultado.classList.remove('oculto');
                } else {
                    alert('Erro ao encurtar link.');
                }
            } catch (err) {
                alert('Erro de conexão com o servidor.');
            }
        });
    </script>
</body>
</html>

